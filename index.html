<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decode Indiaâ€™s Fields | A Geospatial Hackathon</title>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- Leaflet CSS for Interactive Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>

    <!-- Leaflet JS for Interactive Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin="" defer></script>

    <style>
        /* CSS Reset and Basic Setup */
        :root {
            --saffron: #FF9933;
            --green: #138808;
            --white: #ffffff;
            --navy: #000080; /* A dark blue for text */
            --light-gray: #f0f0f0;
            --dark-gray: #333333;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--white);
            color: var(--dark-gray);
            line-height: 1.6;
        }

        /* Container and Section Styling */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        section {
            padding: 4rem 0;
            border-bottom: 1px solid var(--light-gray);
        }

        h1, h2, h3 {
            line-height: 1.2;
            font-weight: 900;
            color: var(--navy);
        }
        
        h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        /* Header and Navigation */
        .main-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .main-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-weight: 900;
            font-size: 1.5rem;
            color: var(--green);
        }

        .main-nav ul {
            list-style: none;
            display: flex;
            gap: 1.5rem;
        }

        .main-nav a {
            text-decoration: none;
            color: var(--navy);
            font-weight: 700;
            transition: color 0.3s ease;
        }

        .main-nav a:hover {
            color: var(--saffron);
        }

        /* Hero Section */
        #hero {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--white);
            overflow: hidden;
            padding-top: 80px; /* Offset for fixed header */
        }

        #bg-video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -2;
            transform: translateX(-50%) translateY(-50%);
        }
        
        #hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }
        
        .hero-content h1 {
            font-size: 4rem;
            color: var(--white);
            margin-bottom: 1rem;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.7);
        }
        
        .hero-content p {
            font-size: 1.5rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Story and Challenge Sections */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            align-items: center;
        }

        #story p {
            font-size: 1.1rem;
        }

        #challenge ul {
            list-style: none;
            padding-left: 0;
        }

        #challenge li {
            background: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23138808"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>') no-repeat left center;
            background-size: 1.5em;
            padding-left: 2em;
            margin-bottom: 1em;
            font-size: 1.1rem;
        }
        
        /* Crop Identification Demo */
        #crop-identification {
            background-color: var(--light-gray);
            text-align: center;
        }

        .crop-demo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        #satellite-image-container {
            width: 100%;
            max-width: 500px;
            height: 300px;
            background-color: #e0e0e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px dashed var(--green);
        }
        
        #satellite-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .btn-analyze, .btn-gemini {
            background-color: var(--green);
            color: var(--white);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .btn-analyze:hover, .btn-gemini:hover {
            background-color: #0e6a06;
            transform: translateY(-2px);
        }

        .btn-gemini {
            background-color: var(--saffron);
            margin-top: 1rem;
        }
        .btn-gemini:hover {
             background-color: #e68a2e;
        }

        #analysis-result {
            margin-top: 1rem;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--navy);
            height: 50px; /* Reserve space to prevent layout shift */
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        #farming-tips-container {
            margin-top: 1.5rem;
            text-align: left;
            width: 100%;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        #farming-tips-container h3 {
            margin-bottom: 0.5rem;
            color: var(--green);
        }

        #farming-tips-result ul {
            list-style-position: inside;
            padding-left: 0;
        }


        .loader {
            border: 4px solid var(--light-gray);
            border-top: 4px solid var(--saffron);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


        /* Interactive Map */
        #map-container {
            text-align: center;
        }
        #map { 
            height: 500px; 
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* Tech Stack */
        .tech-stack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 2rem;
            text-align: center;
        }
        
        .tech-item svg {
            width: 60px;
            height: 60px;
            margin-bottom: 0.5rem;
            fill: var(--navy);
        }

        /* Dataset Section */
        .btn {
            display: inline-block;
            background-color: var(--saffron);
            color: var(--white);
            padding: 0.75rem 1.5rem;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 700;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #e68a2e;
        }
        
        /* Quiz Section */
        #quiz-container {
             max-width: 800px;
             margin: 0 auto;
             background: var(--light-gray);
             padding: 2rem;
             border-radius: 12px;
        }
        .quiz-question {
            margin-bottom: 1.5rem;
        }
        .quiz-question p {
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .quiz-options label {
            display: block;
            margin-bottom: 0.5rem;
        }
        #quiz-result {
            text-align: center;
            font-weight: bold;
            margin-top: 1rem;
            font-size: 1.2rem;
            color: var(--green);
        }

        /* Get Started / Instructions Section */
        #get-started {
            background: var(--light-gray);
        }
        .instructions-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .instructions-container h3 {
            margin-top: 1.5rem;
            color: var(--green);
        }
        .instructions-container ol {
            list-style-position: inside;
        }
        .instructions-container li {
            margin-bottom: 1rem;
        }
        .instructions-container code {
            background-color: #e0e0e0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }

        /* Sticky Call-to-Action Bar */
        .sticky-cta {
            position: fixed;
            bottom: -100px;
            left: 0;
            width: 100%;
            background-color: var(--green);
            color: var(--white);
            text-align: center;
            padding: 1rem;
            font-size: 1.2rem;
            font-weight: 700;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 1001;
            transition: bottom 0.5s ease-in-out;
        }
        .sticky-cta.visible {
            bottom: 0;
        }
        .sticky-cta a {
            color: var(--white);
            text-decoration: none;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr 1fr;
            }
            .hero-content h1 {
                font-size: 5rem;
            }
        }
        
        @media (max-width: 767px) {
            .main-header .container {
                flex-direction: column;
                gap: 1rem;
            }
             .main-nav ul {
                gap: 1rem;
                padding-left: 0;
            }
            h2 {
                font-size: 2rem;
            }
            #hero {
                 height: 80vh;
            }
            .hero-content h1 {
                font-size: 3rem;
            }
            .hero-content p {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>

    <!-- Header and Navigation -->
    <header class="main-header" aria-label="Main navigation">
        <div class="container">
            <div class="logo">Decode Indiaâ€™s Fields</div>
            <nav class="main-nav">
                <ul>
                    <li><a href="#hero">Home</a></li>
                    <li><a href="#challenge">Challenge</a></li>
                    <li><a href="#tech-stack">Tech</a></li>
                    <li><a href="#dataset">Dataset</a></li>
                    <li><a href="#get-started">Get Started</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>

        <!-- Hero Section -->
        <section id="hero">
            <video autoplay muted loop id="bg-video" aria-label="Background video of satellite imagery moving over earth">
                <source src="https://www.nasa.gov/wp-content/uploads/2023/04/goes-east-full-disk-april-20-2023-final.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="hero-content">
                <h1>Decode Indiaâ€™s Fields</h1>
                <p>From Pixels to Produce. Use AI to solve one of India's greatest agricultural challenges.</p>
            </div>
        </section>

        <!-- The Story Section -->
        <section id="story">
            <div class="container grid-2">
                <div>
                    <h2>A Farmer's Hope, A Coder's Challenge</h2>
                    <p>
                        Anita, a smallholder farmer in Uttar Pradesh, looks over her hectare of wheat. Last year, unpredictable weather and pests cut her yield nearly in half. She wonders, "What if I could know my crop's health sooner? What if I could see problems before they take hold?" For millions of farmers like her, data is the difference between prosperity and peril. Her fields, a patchwork quilt of crops, are too small and diverse for traditional monitoring. This is where a satellite's eye and a developer's mind meet. Her hope for a better harvest is now your challenge to solve.
                    </p>
                </div>
                <div>
                     <img src="https://placehold.co/600x400/138808/FFFFFF?text=Indian+Farmland" alt="Illustrative image of a vibrant Indian farm field with a hopeful farmer." style="width:100%; height:auto; border-radius:12px;">
                </div>
            </div>
        </section>

        <!-- The Challenge Section -->
        <section id="challenge">
            <div class="container">
                 <h2 style="text-align: left;">The Challenge: A New Lens for Indian Agriculture</h2>
                 <ul>
                     <li>
                         <strong>Fragmented Fields, Unique Problems:</strong> Unlike the vast, uniform farms in the US or Europe, India's agriculture is a mosaic of small, diverse plots. Your mission is to build a model that thrives in this complexity.
                     </li>
                     <li>
                         <strong>SAR + Optical Fusion:</strong> Go beyond simple images. Combine the all-weather power of Synthetic Aperture Radar (SAR) with rich multispectral data to create a truly robust crop classifier.
                     </li>
                     <li>
                         <strong>India's Eye in the Sky:</strong> Leverage data from Indian-native satellites like ResourceSAT-2/2A and EOS-4, fine-tuning global models with local intelligence for unprecedented accuracy.
                     </li>
                 </ul>
            </div>
        </section>
        
        <!-- AI Crop Identification Demo Section -->
        <section id="crop-identification">
            <div class="container">
                <h2>See the Goal in Action</h2>
                <p style="text-align:center; max-width:700px; margin:0 auto 2rem auto;">Your goal is to build an AI that can do this automatically. Click the button below to see a simulation of a model identifying a crop from a satellite image.</p>
                <div class="crop-demo-container">
                    <div id="satellite-image-container">
                        <img id="demo-image" src="https://placehold.co/500x300/CCCCCC/FFFFFF?text=Satellite+Image" alt="Sample satellite image of an agricultural field.">
                    </div>
                    <button id="analyze-btn" class="btn-analyze" aria-label="Analyze satellite image to identify crop">Analyze Crop</button>
                    <div id="analysis-result">
                        <!-- AI result will be displayed here -->
                    </div>
                    
                    <!-- Gemini Feature: Farming Tips -->
                    <div id="gemini-feature-container" style="display: none; width: 100%;">
                         <button id="get-tips-btn" class="btn-gemini" aria-label="Get AI-powered farming tips for the identified crop">âœ¨ Get Farming Tips</button>
                         <div id="farming-tips-container" style="display: none;">
                            <h3>Expert Farming Tips</h3>
                            <div id="farming-tips-result">
                                <!-- Gemini result will be displayed here -->
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Interactive Map Section -->
        <section id="map-container">
            <div class="container">
                <h2>Explore the Challenge Regions</h2>
                <p style="text-align:center; margin-bottom: 2rem;">The hackathon focuses on fields across four key states. Click on a region to see a sample Sentinel-2 satellite image.</p>
                <div id="map"></div>
            </div>
        </section>

        <!-- Tech Stack Section -->
        <section id="tech-stack">
            <div class="container">
                <h2>The Tech Stack</h2>
                <div class="tech-stack-grid">
                    <div class="tech-item" aria-label="Python">
                        <svg viewBox="0 0 24 24"><path d="M14.5,14.08L16.5,12.08L14.5,10.08L16.67,10.08L19.08,12.5L14.5,17.08L14.5,14.08M9.5,14.08L7.5,12.08L9.5,10.08L7.33,10.08L4.92,12.5L9.5,17.08L9.5,14.08M12.5,20.08L15,22.58L15,24H9V22.58L11.5,20.08H12.5M12.5,3.92L10,1.42L10,0H14V1.42L11.5,3.92H12.5M12,4.92C14.75,4.92 17,7.17 17,9.92C17,12.67 14.75,14.92 12,14.92C9.25,14.92 7,12.67 7,9.92C7,7.17 9.25,4.92 12,4.92Z" /></svg>
                        <p>Python</p>
                    </div>
                    <div class="tech-item" aria-label="PyTorch">
                        <svg viewBox="0 0 24 24"><path d="M21.19,10.35L20,9.58V9.5C20,7 18,5 15.5,5H9.5C7,5 5,7 5,9.5V10.5H3V9.5C3,5.91 5.91,3 9.5,3H15.5C19.09,3 22,5.91 22,9.5V9.92L21.19,10.35M19,13.5V14.5H21V13.5C21,11.09 19.09,9.17 16.69,9.03L15.93,12.96C17.77,13.2 19,13.5 19,13.5M2.81,13.65L4,14.42V14.5C4,17 6,19 8.5,19H14.5C17,19 19,17 19,14.5V13.5H21V14.5C21,18.09 18.09,21 14.5,21H8.5C4.91,21 2,18.09 2,14.5V14.08L2.81,13.65M8.07,11.04C6.23,10.8 5,10.5 5,10.5V9.5H3V10.5C3,12.91 4.91,14.83 7.31,14.97L8.07,11.04Z" /></svg>
                        <p>PyTorch</p>
                    </div>
                    <div class="tech-item" aria-label="Geospatial Foundation Models">
                       <svg viewBox="0 0 24 24"><path d="M12,2C15.31,2 18,4.69 18,8C18,12.25 12,22 12,22S6,12.25 6,8C6,4.69 8.69,2 12,2M12,11.5A3.5,3.5 0 0,1 8.5,8A3.5,3.5 0 0,1 12,4.5A3.5,3.5 0 0,1 15.5,8A3.5,3.5 0 0,1 12,11.5Z" /></svg>
                        <p>Geospatial Foundation Models</p>
                    </div>
                    <div class="tech-item" aria-label="RasterVision">
                        <svg viewBox="0 0 24 24"><path d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z" /></svg>
                        <p>RasterVision</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dataset Section -->
        <section id="dataset">
            <div class="container" style="text-align: center;">
                <h2>A Uniquely Indian Dataset</h2>
                <p style="max-width: 700px; margin: 0 auto 2rem auto;">
                    You'll be working with the AgriFieldNet India dataset. Originally created by Radiant Earth Foundation, it has been enhanced byIBM Research with crucial SAR and optical observations from ISRO and EPA satellite sources. This provides an unprecedented multi-sensor view of Indian agriculture, tailor-made for this challenge.
                </p>
                <a href="#" class="btn" aria-label="Download sample dataset, 5 megabytes">Download Sample (5 MB)</a>
            </div>
        </section>
        
        <!-- Quick Quiz Section -->
        <section id="quiz">
            <div class="container">
                 <h2>Test Your Knowledge</h2>
                 <div id="quiz-container">
                     <form id="quiz-form">
                         <div class="quiz-question">
                             <p>1. What does SAR stand for?</p>
                             <div class="quiz-options">
                                 <label><input type="radio" name="q1" value="a" required> Synthetic Aperture Radar</label>
                                 <label><input type="radio" name="q1" value="b"> Satellite Array Radio</label>
                                 <label><input type="radio" name="q1" value="c"> Soil Analysis Raster</label>
                             </div>
                         </div>
                         <div class="quiz-question">
                             <p>2. Which is NOT a benefit of SAR for agriculture?</p>
                             <div class="quiz-options">
                                 <label><input type="radio" name="q2" value="a" required> It can see through clouds.</label>
                                 <label><input type="radio" name="q2" value="b"> It can measure crop color.</label>
                                 <label><input type="radio" name="q2" value="c"> It works day and night.</label>
                             </div>
                         </div>
                         <div class="quiz-question">
                             <p>3. The hackathon dataset is enhanced with data from which Indian space agency satellite?</p>
                             <div class="quiz-options">
                                 <label><input type="radio" name="q3" value="a" required> Mangalyaan</label>
                                 <label><input type="radio" name="q3" value="b"> Chandrayaan</label>
                                 <label><input type="radio" name="q3" value="c" required> ResourceSAT</label>
                             </div>
                         </div>
                         <button type="submit" class="btn-analyze" style="width: 100%;">Check Score</button>
                     </form>
                     <div id="quiz-result"></div>
                 </div>
            </div>
        </section>

        <!-- Get Started (Instructions) Section -->
        <section id="get-started">
            <div class="container">
                <h2>Your Path to Success: Step-by-Step Guide</h2>
                <div class="instructions-container">
                    <p>Follow these steps to build and fine-tune your crop classification model. This guide is designed for participants with backgrounds in machine learning, geospatial analysis, or agritech.</p>
                    
                    <h3>1. Understand the Dataset and Tools</h3>
                    <ol>
                        <li><strong>Access the Dataset:</strong> Download the full AgriFieldNet India training dataset. It combines ground truth labels with SAR data (Sentinel-1/EOS-4) and multispectral imagery (ResourceSAT-2/2A, Sentinel-2).</li>
                        <li><strong>Key Data Types:</strong> Familiarize yourself with SAR for all-weather crop structure analysis and Multispectral for identifying crop types via spectral signatures (like NDVI).</li>
                        <li><strong>Recommended Tools:</strong> Use Python with libraries like PyTorch or TensorFlow, Rasterio/GDAL for geospatial data, and scikit-learn for evaluation.</li>
                    </ol>

                    <h3>2. Preprocess the Data</h3>
                    <ol>
                        <li><strong>Load and Merge Data:</strong> Combine SAR and multispectral bands into a unified feature set. Align observations to the same dates or seasons to handle temporal mismatches.</li>
                        <li><strong>Data Augmentation:</strong> Apply techniques like rotation, flipping, or noise addition to improve model robustness, especially for small, fragmented fields.</li>
                        <li><strong>Label Preparation:</strong> Create training/validation splits (e.g., 80/20) and ensure your classes (wheat, rice, pulses) are balanced.</li>
                    </ol>

                    <h3>3. Build and Fine-Tune the Model</h3>
                    <ol>
                        <li><strong>Start with a Foundation Model:</strong> Use a pre-trained geospatial foundation model as your backbone. Fine-tune it with our Indian-specific dataset to adapt it to local farming variations.</li>
                        <li><strong>Model Architecture:</strong> Implement a multi-modal approach (CNN or Transformer) that fuses SAR and multispectral inputs effectively.</li>
                        <li><strong>Training Process:</strong> Start with hyperparameters like learning rate ~0.001, batch size 32. Optimize for accuracy and F1-score, and test generalization on unseen districts.</li>
                    </ol>
                    
                    <h3>4. Evaluate and Iterate</h3>
                     <ol>
                        <li><strong>Metrics:</strong> Measure performance with precision, recall, and confusion matrices.</li>
                        <li><strong>Validation:</strong> Cross-validate across states to ensure your model generalizes well.</li>
                        <li><strong>Iterate:</strong> Analyze errors using error maps and refine your model.</li>
                    </ol>
                    
                    <h3>5. Submit and Deploy</h3>
                     <ol>
                        <li><strong>Hackathon Submission:</strong> Package your model, code, and a brief report.</li>
                        <li><strong>Real-World Tips:</strong> For bonus points, discuss how your model could be deployed for scalability using tools like Google Earth Engine.</li>
                    </ol>
                </div>
            </div>
        </section>

    </main>

    <!-- Sticky Call-to-Action Bar -->
    <div class="sticky-cta" id="sticky-cta" aria-label="Join the hackathon call to action">
        <a href="#">Join the Hackathon &rarr;</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- Smooth Scrolling for Navigation ---
            const navLinks = document.querySelectorAll('.main-nav a');
            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetSection = document.querySelector(targetId);
                    if (targetSection) {
                        // Adjust for fixed header height
                        const headerOffset = 80;
                        const elementPosition = targetSection.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });
                    }
                });
            });

            // --- Sticky Call-to-Action Bar Logic ---
            const stickyCta = document.getElementById('sticky-cta');
            let lastScrollY = window.scrollY;

            window.addEventListener('scroll', () => {
                if (lastScrollY > window.scrollY && window.scrollY > 300) {
                    stickyCta.classList.add('visible');
                } else {
                    stickyCta.classList.remove('visible');
                }
                lastScrollY = window.scrollY;
            });

            // --- AI Crop Identification Demo Logic ---
            const analyzeBtn = document.getElementById('analyze-btn');
            const analysisResult = document.getElementById('analysis-result');
            const demoImage = document.getElementById('demo-image');
            
            // --- Gemini Feature Elements ---
            const geminiFeatureContainer = document.getElementById('gemini-feature-container');
            const getTipsBtn = document.getElementById('get-tips-btn');
            const farmingTipsContainer = document.getElementById('farming-tips-container');
            const farmingTipsResult = document.getElementById('farming-tips-result');

            const sampleImages = [
                'https://placehold.co/500x300/228B22/FFFFFF?text=Field+A',
                'https://placehold.co/500x300/8B4513/FFFFFF?text=Field+B',
                'https://placehold.co/500x300/006400/FFFFFF?text=Field+C',
            ];
            
            let currentCrop = null; // Variable to store the identified crop

            analyzeBtn.addEventListener('click', async () => {
                // Reset Gemini feature UI
                geminiFeatureContainer.style.display = 'none';
                farmingTipsContainer.style.display = 'none';
                farmingTipsResult.innerHTML = '';
                
                // Show loader and disable button
                analysisResult.innerHTML = '<div class="loader"></div>';
                analyzeBtn.disabled = true;
                
                // Change image to a new random one
                const randomImage = sampleImages[Math.floor(Math.random() * sampleImages.length)];
                demoImage.src = randomImage;

                try {
                    // Call the backend API
                    const response = await fetch('http://localhost:5000/analyze-crop', {
                        method: 'POST',
                        mode: 'cors',
                        cache: 'no-cache',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ imageUrl: randomImage }) 
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    
                    const data = await response.json();
                    currentCrop = data.crop; // Store the crop name

                    // Display result from backend
                    analysisResult.innerHTML = `
                        <strong>Detected:</strong> ${data.crop} <br> 
                        <strong>Confidence:</strong> ${data.confidence}%
                    `;
                    
                    // Show the Gemini feature button
                    geminiFeatureContainer.style.display = 'block';

                } catch (error) {
                    console.error("Error calling analysis API:", error);
                    analysisResult.innerHTML = "<span><strong>Connection Error:</strong> Could not reach the analysis server. Please ensure the Python backend is running.</span>";
                } finally {
                    // Re-enable the button
                    analyzeBtn.disabled = false;
                }
            });

            getTipsBtn.addEventListener('click', async () => {
                if (!currentCrop) return;

                farmingTipsContainer.style.display = 'block';
                farmingTipsResult.innerHTML = '<div class="loader"></div>';
                getTipsBtn.disabled = true;

                try {
                     // Call the new backend endpoint for Gemini
                    const response = await fetch('http://localhost:5000/get-farming-tips', {
                        method: 'POST',
                        mode: 'cors',
                        cache: 'no-cache',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ cropName: currentCrop }) 
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

                    const data = await response.json();
                    farmingTipsResult.innerHTML = data.tips; // The backend returns ready-to-use HTML

                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    farmingTipsResult.innerHTML = "<span><strong>Connection Error:</strong> Could not retrieve farming tips. Please ensure the Python backend is running.</span>";
                } finally {
                    getTipsBtn.disabled = false;
                }

            });

            // --- Interactive Leaflet Map Initialization ---
            const statesData = {
                "type": "FeatureCollection",
                "features": [
                    { "type": "Feature", "properties": { "name": "Uttar Pradesh", "image": "https://placehold.co/200x150/FF9933/FFFFFF?text=UP+Sentinel-2" }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 77.0, 30.5 ], [ 84.5, 30.5 ], [ 84.5, 23.8 ], [ 77.0, 23.8 ], [ 77.0, 30.5 ] ] ] } },
                    { "type": "Feature", "properties": { "name": "Rajasthan", "image": "https://placehold.co/200x150/138808/FFFFFF?text=Rajasthan+Sentinel-2" }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 69.5, 30.2 ], [ 78.3, 30.2 ], [ 78.3, 23.0 ], [ 69.5, 23.0 ], [ 69.5, 30.2 ] ] ] } },
                    { "type": "Feature", "properties": { "name": "Odisha", "image": "https://placehold.co/200x150/000080/FFFFFF?text=Odisha+Sentinel-2" }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 81.4, 22.5 ], [ 87.5, 22.5 ], [ 87.5, 17.8 ], [ 81.4, 17.8 ], [ 81.4, 22.5 ] ] ] } },
                    { "type": "Feature", "properties": { "name": "Bihar", "image": "https://placehold.co/200x150/FF6347/FFFFFF?text=Bihar+Sentinel-2" }, "geometry": { "type": "Polygon", "coordinates": [ [ [ 83.3, 27.5 ], [ 88.3, 27.5 ], [ 88.3, 24.3 ], [ 83.3, 24.3 ], [ 83.3, 27.5 ] ] ] } }
                ]
            };
            const map = L.map('map').setView([24, 82], 4.5);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                maxZoom: 19
            }).addTo(map);
            function style(feature) {
                const colors = { 'Uttar Pradesh': '#FF9933', 'Rajasthan': '#138808', 'Odisha': '#000080', 'Bihar': '#FF6347' };
                return { fillColor: colors[feature.properties.name] || '#ff0000', weight: 2, opacity: 1, color: 'white', dashArray: '3', fillOpacity: 0.7 };
            }
            L.geoJson(statesData, {
                style: style,
                onEachFeature: function(feature, layer) {
                    const popupContent = `<strong>${feature.properties.name}</strong><br><img src="${feature.properties.image}" alt="Sample satellite image of ${feature.properties.name}" style="width:100%; height:auto; margin-top:5px;">`;
                    layer.bindPopup(popupContent);
                }
            }).addTo(map);

            // --- Quiz Logic ---
            const quizForm = document.getElementById('quiz-form');
            const quizResult = document.getElementById('quiz-result');
            const correctAnswers = { q1: 'a', q2: 'b', q3: 'c' };
            quizForm.addEventListener('submit', function(e) {
                e.preventDefault();
                let score = 0;
                const totalQuestions = Object.keys(correctAnswers).length;
                const formData = new FormData(quizForm);
                for (let [name, value] of formData.entries()) {
                    if (correctAnswers[name] === value) {
                        score++;
                    }
                }
                quizResult.textContent = `You scored ${score} out of ${totalQuestions}!`;
            });
        });
    </script>
</body>
</html>

